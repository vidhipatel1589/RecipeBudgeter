<!DOCTYPE html>
<html lang="en">
<head>
    <title>Recipe Budgeter</title>
    <link rel="stylesheet" href="style.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css'
          rel='stylesheet'>
</head>
<body>

    <!-- navigation bar -->
    <nav class="navbar" id="navbar" style="display: none;">
        <ul>
            <li><a href="#home">Home</a></li>
            <li><a href="#add-recipe">Add A New Recipe</a></li>
            <li><a href="#view-recipes">Update A Recipe</a></li>
            <li><a href="#view-recipe-cost">View Recipe Cost</a></li>
        </ul>
    </nav>

    <div class="wrapper">
        <h1 class="Title">Recipe Budgeter</h1>
        <form id="loginForm">
            <!--added it to be a login form -->
            <h1>Login</h1>
            <div class="input-box">
                <input type="text" id="username" placeholder="Username/Email"
                       required> <!--changed type to text so it wud work w js-->
                <i class='bx bxs-user'></i>
            </div>

            <div class="input-box">
                <input type="password" id="password"
                       placeholder="Password" required>
                <i class='bx bxs-lock-alt'></i>
            </div>

            <button type="submit" class="login-button">Login</button>

            <div class="register">
                <a href="#">Create Account</a>
            </div>
        </form>
    </div>

    <!------------------------------------------------------------------------------------------->
    <!-- for home page -->
    <div class="section" id="home" style="display: none;">
        <h2>Welcome to Recipe Budgeter</h2>
        <p>Here are your recipes!</p>
        <p>Omelet</p>
        <p>Chicken and Rice</p>
    </div>

    <!------------------------------------------------------------------------------------------->
    <!-- for recipe page -->
    <div class="section" id="add-recipe" style="display: none;">
        <h2>Add Your Recipe</h2>
        <form action="" class="add-recipe-entry">
            <div class="input-box">
                <input type="text" placeholder="Recipe Name" required>
            </div>
            <div class="ingredients-list" id="ingredients-list">
                <div class="ingredient">
                    <input type="text" id="ingredientInput" placeholder="Ingredient" required oninput="filterIngredients()">
                    <input type="number" placeholder="Quantity" required>
                    <select>
                        <option value="Units">Units</option>
                        <option value="Cups">Cups</option>
                        <option value="Pounds">Pounds</option>
                        <option value="Ounces">Ounces</option>
                    </select>
                </div>
            </div>

            <button type="button" onclick="addIngredient()">Add Another Ingredient</button>

            <button type="submit" class="save-button">Save Recipe</button>
        </form>
    </div>

    <!------------------------------------------------------------------------------------------->
    <!-- for recipes section -->
    <div class="section" id="view-recipes" style="display: none;">
        <h2>List of Recipes</h2>
        <!-- select recipe -->
        <select id="chooseRecipeUpdate" onchange="loadRecipeData()">
            <option value="">Select a recipe</option>
        </select>

        <!-- to allow update recipe -->
        <form id="updateRecipeForm" style="display: none;">
            <div class="input-box">
                <label for="recipeName">Recipe Name:</label>
                <input type="text" id="recipeName" required>
            </div>

            <div id="ingredient-list">

            </div>

            <button type="button" onclick="addAnotherIngredient()">Add Another Ingredient</button>
            <button type="button" onclick="saveRecipe()">Save</button>
        </form>
    </div>

    <!------------------------------------------------------------------------------------------->
    <!-- for recipe cost section -->
    <div class="section" id="view-recipe-cost" style="display: none;">
        <h2>Recipe Cost</h2>

        <!-- choose recipe to see cost -->
        <select id="chooseRecipeCost">
            <option value="">Select a recipe</option>
        </select>

        <!-- view cost -->
        <button onclick="viewRecipeCost()">View</button>

        <!-- see details -->
        <div id="recipeCostDetails" style="display: none;">
            <h3 id="chosenRecipeName"></h3>
            <table>
                <thead>
                    <tr>
                        <th>Ingredient</th>
                        <th>Quantity</th>
                        <th>Unit</th>
                        <th>Price</th>
                        <th>Availability</th>
                    </tr>
                </thead>
                <tbody id="ingredientCostList">
                    <!-- Populated with JS -->
                </tbody>
            </table>
            <h4>Total Cost: <span id="totalCost"></span></h4>
        </div>
    </div>

    <!------------------------------------------------------------------------------------------->



    <script>
        //test to check if username and password work
        function validateLogin(username, password) {
            return username === "username" && password === "password";
        }

        //handles the login function
        document.getElementById('loginForm').addEventListener('submit', function (event) {
            event.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            if (validateLogin(username, password)) {
                //navigation bar becomes visible after logging in
                document.getElementById('navbar').style.display = 'block';
                showSection('home');    //open at home page
                //login form goes away after logging in
                document.querySelector('.wrapper').style.display = 'none';
            } else {
                alert('Invalid username or password. Please try again.');
            }
        });

        //hide other pages when switching through pages on nav bar
        function showSection(sectionId) {
            //get sections
            const sections = document.querySelectorAll('.section');

            //hide other sections
            sections.forEach(section => {
                section.style.display = 'none';
            });

            //show selected section
            document.getElementById(sectionId).style.display = 'block';
        }

        ////////////////////////////////////////////////////////////////////////////////////////

        // temporary list of ingredients, get from database instead later
        const ingredients = [
            "Salt",
            "Pepper",
            "Eggs",
            "Butter",
            "Rice",
            "Spinach",
            "Onion",
            "Tomato",
            "Olive oil",
            "Chicken"
        ];

        // temporary list of recipes, get from database later
        const recipes = {
            "Omelet": { name: "Omelet", ingredients: [{ ingredient: "Eggs", quantity: 2, unit: "Units", price: 0.50, available: true }, { ingredient: "spinach", quantity: 10, unit: "Ounces", price: 0.20, available: true }] },
            "Chicken and Rice": { name: "Chicken and Rice", ingredients: [{ ingredient: "chicken", quantity: 1, unit: "Pounds", price: 4.00, available: true }, { ingredient: "rice", quantity: 1, unit: "Cups", price: 1.20, available: true }] }
        };

        ////////////////////////////////////////////////////////////////////////////////////////

        document.querySelectorAll('.navbar a').forEach(link => {
            link.addEventListener('click', function (event) {
                event.preventDefault();
                const targetSection = this.getAttribute('href').substring(1);
                showSection(targetSection);
            });
        });

        ////////////////////////////////////////////////////////////////////////////////////////

        //when user types, it'll find the ingredient in the list
        function filterIngredients() {
            const input = document.getElementById('ingredientInput');
            const filter = input.value.toLowerCase();
            const dropdown = document.getElementById('dropdownContent');
            dropdown.innerHTML = ''; // Clear previous results

            if (filter) {
                const filteredIngredients = ingredients.filter(ingredient => ingredient.toLowerCase().includes(filter));

                filteredIngredients.forEach(ingredient => {
                    const div = document.createElement('div');
                    div.textContent = ingredient;
                    div.onclick = () => selectIngredient(ingredient);
                    dropdown.appendChild(div);
                });

                //show list
                dropdown.style.display = filteredIngredients.length > 0 ? 'block' : 'none';
            } else {
                dropdown.style.display = 'none'; //if none match
            }
        }

        //choose from dropdown list
        function selectIngredient(ingredient) {
            document.getElementById('ingredientInput').value = ingredient;
            document.getElementById('dropdownContent').style.display = 'none';
        }

        //to add another ingredient when listing ingredients for new recipe
        function addIngredient() {
            const ingredientsList = document.getElementById('ingredients-list');

            const ingredientDiv = document.createElement('div');
            ingredientDiv.className = 'ingredient';

            //fields for new ingredient
            ingredientDiv.innerHTML = `
            <input type="text" placeholder="Ingredient" required oninput="filterIngredients()">
            <input type="number" placeholder="Quantity" required>
            <select>
                <option value="Units">Units</option>
                <option value="Cups">Cups</option>
                <option value="Pounds">Pounds</option>
                <option value="Ounces">Ounces</option>
            </select>
        `;

            ingredientsList.appendChild(ingredientDiv);
        }

        ////////////////////////////////////////////////////////////////////////////////////////

        //dropdown for recipes
        function populateDropdown() {
            const dropdown = document.getElementById('chooseRecipeUpdate');
            for (let recipeName in recipes) {
                const option = document.createElement('option');
                option.value = recipeName;
                option.textContent = recipeName;
                dropdown.appendChild(option);
            }
        }
        populateDropdown();

        //get list of recipes to choose from
        function loadRecipeData() {
            const chosenRecipeName = document.getElementById('chooseRecipeUpdate').value;
            if (chosenRecipeName) {
                const recipe = recipes[chosenRecipeName];
                document.getElementById('recipeName').value = recipe.name;

                //clear out previous
                const ingredientsList = document.getElementById('ingredient-list');
                ingredientsList.innerHTML = '';

                //list out the ingredients
                recipe.ingredients.forEach((ingredient, index) => {
                    const ingredientDiv = document.createElement('div');
                    ingredientDiv.className = 'ingredient-entry';
                    ingredientDiv.innerHTML = `
                                        <input type="text" value="${ingredient.ingredient}" class="ingredient-name">
                                        <input type="number" value="${ingredient.quantity}" class="ingredient-quantity">
                                        <input type="text" value="${ingredient.unit}" class="ingredient-unit">
                                    `;
                    ingredientsList.appendChild(ingredientDiv);
                });

                //show form to update recipe
                document.getElementById('updateRecipeForm').style.display = 'block';
            } else {
                //clear if no recipe chosen
                document.getElementById('updateRecipeForm').style.display = 'none';
            }
        }

        //add another ingredient to recipe
        function addAnotherIngredient() {
            const ingredientsList = document.getElementById('ingredient-list');

            const ingredientDiv = document.createElement('div');
            ingredientDiv.className = 'ingredient-entry';
            ingredientDiv.innerHTML = `
                <input type="text" class="ingredient-name" placeholder="Ingredient Name" required>
                <input type="number" class="ingredient-quantity" placeholder="Quantity" required>
                <select class="ingredient-unit">
                        <option value="Units">Units</option>
                        <option value="Cups">Cups</option>
                        <option value="Pounds">Pounds</option>
                        <option value="Ounces">Ounces</option>
                </select>
                `;

                ingredientsList.appendChild(ingredientDiv);
        }

        //say recipe is saved
        function saveRecipe() {
            const recipeName = document.getElementById('recipeName').value;
            const ingredientsList = document.getElementById('ingredient-list').children;

            const updatedIngredients = Array.from(ingredientsList).map(ingredientDiv => ({
                ingredient: ingredientDiv.querySelector('.ingredient-name').value,
                quantity: parseFloat(ingredientDiv.querySelector('.ingredient-quantity').value),
                unit: ingredientDiv.querySelector('.ingredient-unit').value
            }));

            //update the recipe (change later to connect to database)
            recipes[recipeName] = { name: recipeName, ingredients: updatedIngredients };

            alert('Recipe updated successfully!');
        }

        ////////////////////////////////////////////////////////////////////////////////////////

        //shows dropdown for the recipes to select from to show cost
        function populateRecipeCostDropdown() {
            const dropdown = document.getElementById('chooseRecipeCost');
            dropdown.innerHTML = '<option value="">Select a recipe</option>'; //to reset

            for (const recipeName in recipes) {
                const option = document.createElement('option');
                option.value = recipeName;
                option.textContent = recipeName;
                dropdown.appendChild(option);
            }
        }
        populateRecipeCostDropdown();

        //show recipe cost details
        function viewRecipeCost() {
            const chosenRecipeName = document.getElementById('chooseRecipeCost').value;
            const recipeDetailsDiv = document.getElementById('recipeCostDetails');
            const ingredientCostList = document.getElementById('ingredientCostList');
            const totalCostElement = document.getElementById('totalCost');

            if (chosenRecipeName && recipes[chosenRecipeName]) {
                const recipe = recipes[chosenRecipeName];
                document.getElementById('chosenRecipeName').textContent = recipe.name;
                ingredientCostList.innerHTML = '';

                let totalCost = 0;  //to start with then add the costs

                //show the list of recipe details with cost
                recipe.ingredients.forEach((ingredient) => {
                    const row = document.createElement('tr');

                    row.innerHTML = `
                                    <td>${ingredient.ingredient}</td>
                                    <td>${ingredient.quantity}</td>
                                    <td>${ingredient.unit}</td>
                                    <td>$${(ingredient.price * ingredient.quantity).toFixed(2)}</td>
                                    <td>${ingredient.available ? "In Stock" : "Out of Stock"}</td>
                                `;

                    ingredientCostList.appendChild(row);
                    totalCost += ingredient.price * ingredient.quantity;
                });

                totalCostElement.textContent = `$${totalCost.toFixed(2)}`;
                recipeDetailsDiv.style.display = 'block';
            } else {
                recipeDetailsDiv.style.display = 'none';
                alert('Select a recipe.');
            }
        }

    </script>



</body>
</html>