<!DOCTYPE html>
<html lang="en">
<head>
    <title>Recipe Budgeter</title>
    <link rel="stylesheet" href="style.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css'
          rel='stylesheet'>
</head>
<body>
    <div class="wrapper">
        <h1 class="Title">Recipe Budgeter</h1>
        <form id="loginForm">
            <h1>Login</h1>
            <div class="input-box">
                <input type="text" id="username" placeholder="Username/Email"
                       required>
                <i class='bx bxs-user'></i>
            </div>

            <div class="input-box">
                <input type="password" id="password"
                       placeholder="Password" required>
                <i class='bx bxs-lock-alt'></i>
            </div>

            <button type="submit" class="login-button">Login</button>

            <div class="register">
                <a href="#" onclick="showSignup()">Create Account</a>
            </div>
        </form>
    </div>

    <div class="wrapper" id="signupWrapper" style="display: none;"> 
        <form id="signupForm">
            <h1 class="Title">Recipe Budgeter</h1>
            <h1 class="Subtitle">Sign Up</h1>

            <div class="input-box">
                <input type="text" id="name" placeholder="Name" required>
                <i class='bx bxs-envelope'></i>
            </div>  

            <div class="input-box">
                <input type="text" id="newUsername" placeholder="Username" required>
                <i class='bx bxs-user'></i>
            </div> 

            <div class="input-box">
                <input type="password" id="newPassword" placeholder="Password" required>
                <i class="bx bxs-lock-alt"></i>
            </div>

            <div class="input-box">
                <input type="password" id="confirmpassword" placeholder="Confirm Password" required>
                <i class='bx bxs-lock-alt'></i>
            </div>     
            
            <button type="submit" class="login-button">Sign Up</button>

            <div class="register">
                <a href="#" onclick="showLogin()">Already have an account? Login</a>
            </div>    
        </form>
    </div>

    <!-- navigation bar -->
    <nav class="navbar" id="navbar" style="display: none;">
        <ul>
            <li><a href="#home">Home</a></li>
            <li><a href="#add-recipe">Add A New Recipe</a></li>
            <li><a href="#view-recipes">Update A Recipe</a></li>
            <li><a href="#view-recipe-cost">View Recipe Cost</a></li>
            <li><a href="#" onclick="showLogin()">Logout</a></li>
        </ul>
    </nav>

    <!------------------------------------------------------------------------------------------->
    <!-- for home page -->
    <div class="section" id="home" style="display: none;">
        <h2>Welcome to Recipe Budgeter</h2>
        <h1>Here are your recipes!</h1>
        <h3 style="text-align: center;">Click on a recipe to view details</h3>

        <!--recipe list-->
        <div id="recipeList">
            <!-- Populated with JS -->
        </div>


        <!--recipe cost details for home page -->
        <div id="recipeCostDetailsHome" style="display: none;">
            <h4 id="chosenRecipeNameHome"></h4>
            <div class="description-box">
                <textarea readonly id="recipeDescriptionBox" placeholder="Recipe Description" required></textarea>
            </div> 
            <table>
                <thead>
                    <tr>
                        <th>Ingredient</th>
                        <th>Quantity</th>
                        <th>Unit</th>
                        <th>Price</th>
                        <th>Availability</th>
                    </tr>
                </thead>
                <tbody id="ingredientCostListHome">

                </tbody>
            </table>
            <h5>Total Cost: <span id="totalCostHome"></span></h5>
        </div>

    </div>

    <!------------------------------------------------------------------------------------------->
    <!-- for add new recipe page -->
    <div class="section" id="add-recipe" style="display: none;">
        <h2>Add Your Recipe</h2>
        <h3 style="text-align: center;">Add your own recipe</h3>
        <form action="" class="add-recipe-entry">
            <div class="input-box">
                <input type="text" placeholder="Recipe Name" required>
            </div>
            <div class="description-box">
                <textarea placeholder="Recipe Description" required></textarea>
            </div>    
            <div class="ingredients-list" id="ingredients-list">
                <div class="ingredient">
                    <select class="ingredientDropdown" required>
                        <option value="">Select Ingredient</option>
                    </select>
                    <input type="number" placeholder="Quantity" required min="0" class="initialQuantity">
                    <select class="unitDropdown" required>
                        <option value="">Select Units</option>
                    </select>
                    <button type="button" class="X-button" onclick="deleteIngredient(this)">X</button>
                </div>                
            </div>

            <button type="button" onclick="addIngredient()">Add Another Ingredient</button>
            <button type="button" onclick="saveNewRecipe()">Save Recipe</button>
        </form>
    </div>

    <script>
        // Prevent negative input for initial quantity field on page load
        document.addEventListener("DOMContentLoaded", () => {
            // Attach event listeners to existing `.initialQuantity` fields
            const quantityInputs = document.querySelectorAll('.initialQuantity');
            quantityInputs.forEach(input => {
                input.addEventListener('input', () => {
                    if (input.value < 0) {
                        input.value = 0; // Reset to 0 if negative
                    }
                });
            });
        });

        // Populate all ingredient dropdowns
        function populateAddItemDropdown() {
            const items = JSON.parse(localStorage.getItem('items')) || {};
            const dropdowns = document.querySelectorAll('.ingredientDropdown'); // Select all elements with class ingredientDropdown

            dropdowns.forEach(dropdown => {
                dropdown.innerHTML = '<option value="">Select Ingredient</option>'; // Reset options

                for (const [name, id] of Object.entries(items)) {
                    const option = document.createElement('option');
                    option.value = id; // Set value as the item's ID
                    option.textContent = name; // Set text as the item's name
                    dropdown.appendChild(option);
                }
            });
        }

        // Populate all unit dropdowns
        function populateAddUnitDropdown() {
            const conversions = JSON.parse(localStorage.getItem('conversions')) || {};
            const dropdowns = document.querySelectorAll('.unitDropdown'); // Select all elements with class unitDropdown

            dropdowns.forEach(dropdown => {
                dropdown.innerHTML = '<option value="">Select Units</option>'; // Reset options

                for (const unitName of Object.keys(conversions)) {
                    const option = document.createElement('option');
                    option.value = unitName; // Set value as the unit name
                    option.textContent = unitName; // Set text as the unit name
                    dropdown.appendChild(option);
                }
            });
        }

        // Generalized function to populate any dropdown
        function populateAddNewDropdown(dropdown, storageKey) {
            const data = JSON.parse(localStorage.getItem(storageKey)) || {};
            const dropdowns = dropdown instanceof NodeList || Array.isArray(dropdown) ? dropdown : [dropdown]; // Handle single or multiple elements

            dropdowns.forEach(dd => {
                dd.innerHTML = '<option value="">Select ' + (storageKey === 'items' ? 'Ingredient' : 'Units') + '</option>'; // Reset options

                for (const [name, value] of Object.entries(data)) {
                    const option = document.createElement('option');
                    option.value = value; // Set value (ID for items, name for conversions)
                    option.textContent = name; // Set text (name for both items and conversions)
                    dd.appendChild(option);
                }
            });
        }

        // Initial population of dropdowns
        populateAddItemDropdown();
        populateAddUnitDropdown();
    </script>

    <!------------------------------------------------------------------------------------------->
    <!-- for update a recipe page -->
    <div class="section" id="view-recipes" style="display: none;">
        <h2>List of Recipes</h2>
        <h3 style="text-align: center;">Select a recipe</h3>
        <!-- select recipe -->
        <select id="chooseRecipeUpdate" onchange="loadRecipeData()">
            <option value="">Select a recipe</option>
        </select>

        <!-- to allow update recipe -->
        <form id="updateRecipeForm" style="display: none;">
            <h1>
                <input type="text" id="recipeName" required>
            </h1>
            
            <div class="description-box">
                <textarea placeholder="Recipe Description" required></textarea>
            </div>  
            <div class="ingredients-list" id="ingredient-list">
                <div class="ingredient">
                    <input type="number" placeholder="Quantity" required min = "0">
                    <select>
                        <option value="Units">Units</option>
                        <option value="Cups">Cups</option>
                        <option value="Pounds">Pounds</option>
                        <option value="Ounces">Ounces</option>
                    </select>
                    <button  type="button" class="X-button" onclick="deleteIngredient(this)">X</button>
                </div>
            </div>

            <button type="button" onclick="addAnotherIngredient()">Add Another Ingredient</button>
            <button type="button" onclick="updateRecipe()">Save Recipe</button>
            <button type="button" onclick="deleteRecipe()">Delete Recipe</button>
        </form>
    </div>

    <!------------------------------------------------------------------------------------------->
    <!-- for view recipe cost page -->
    <div class="section" id="view-recipe-cost" style="display: none;">
        <h2>Recipe Cost</h2>
        
        <!-- choose recipe to see cost -->
        <select id="chooseRecipeCost" onchange="viewRecipeCost()">
            <option value="">Select a recipe</option>
        </select>

        <!-- see details -->
        <div id="recipeCostDetails" style="display: none;">
            <h3 id="chosenRecipeName"></h3>
            <div class="description-box">
                <textarea readonly id="recipeDescriptionCostBox" placeholder="Recipe Description" required></textarea>
            </div> 
            <table>
                <thead>
                    <tr>
                        <th>Ingredient</th>
                        <th>Quantity</th>
                        <th>Unit</th>
                        <th>Price</th>
                        <th>Availability</th>
                    </tr>
                </thead>
                <tbody id="ingredientCostList">
                    <!-- Populated with JS -->
                </tbody>
            </table>
            <h4>Total Cost: <span id="totalCost"></span></h4>
        </div>
    </div>

    <!------------------------------------------------------------------------------------------->
    <script src="js/login.js"></script>
    <script src="js/home.js"></script>
    <script src="js/updateRecipe.js"></script>
    <script>

        function showLogin() {
            document.getElementById('signupWrapper').style.display = 'none';
            document.querySelector('.wrapper').style.display = 'block';
            document.getElementById('navbar').style.display = 'none';
               document.getElementById('username').value = '';
    document.getElementById('password').value = '';
        }

        function showSignup() {
            document.querySelector('.wrapper').style.display = 'none';
            document.getElementById('signupWrapper').style.display = 'block';
        }

        //hide other pages when switching through pages on nav bar
        function showSection(sectionId) {
            //get sections
            const sections = document.querySelectorAll('.section');

            //hide other sections
            sections.forEach(section => {
                section.style.display = 'none';
            });

            //show selected section
            document.getElementById(sectionId).style.display = 'block';
        }

        ////////////////////////////////////////////////////////////////////////////////////////

        // temporary list of ingredients, get from database instead later
        // const ingredients = [
        //     "Salt",
        //     "Pepper",
        //     "Eggs",
        //     "Butter",
        //     "Rice",
        //     "Spinach",
        //     "Onion",
        //     "Tomato",
        //     "Olive oil",
        //     "Chicken"
        // ];

        // temporary list of recipes, get from database later
        // const recipes = {
        //     "Omelet": { name: "Omelet", ingredients: [{ ingredient: "Eggs", quantity: 2, unit: "Units", price: 0.50, available: true }, { ingredient: "spinach", quantity: 10, unit: "Ounces", price: 0.20, available: true }] },
        //     "Chicken and Rice": { name: "Chicken and Rice", ingredients: [{ ingredient: "chicken", quantity: 1, unit: "Pounds",available: false }, { ingredient: "rice", quantity: 1, unit: "Cups", price: 1.20, available: true }] }, 
        // };

        let recipes = convertRecipes();

        ////////////////////////////////////////////////////////////////////////////////////////

        document.querySelectorAll('.navbar a').forEach(link => {
            link.addEventListener('click', function (event) {
                event.preventDefault();
                const targetSection = this.getAttribute('href').substring(1);
                showSection(targetSection);
            });
        });

        ////////////////////////////////////////////////////////////////////////////////////////

        //list of clickable recipes on the home page
        function populateRecipeList() {
            const recipeList = document.getElementById('recipeList');

            recipeList.innerHTML = '';

            for (const recipeName in recipes) {
                const recipeItem = document.createElement('div');
                recipeItem.className = 'recipe-item';
                recipeItem.textContent = recipeName;
                recipeItem.onclick = () => showRecipeDetailsOnHome(recipeName);
                recipeList.appendChild(recipeItem);
                
            }
        }
        populateRecipeList();

        function showRecipeDetailsOnHome(chosenRecipeName) {
            const recipeDetailsDiv = document.getElementById('recipeCostDetailsHome');
            const ingredientCostList = document.getElementById('ingredientCostListHome');
            const totalCostElement = document.getElementById('totalCostHome');

            if (chosenRecipeName && recipes[chosenRecipeName]) {
                const recipe = recipes[chosenRecipeName];
                document.getElementById('chosenRecipeNameHome').textContent = recipe.name;
                const recipeDescription = document.getElementById('recipeDescriptionBox');

                ingredientCostList.innerHTML = '';
                recipeDescription.value = recipe.description;

                let totalCost = 0;


                recipe.ingredients.forEach((ingredient) => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                <td>${ingredient.ingredient}</td>
                <td>${ingredient.quantity}</td>
                <td>${ingredient.unit}</td>
                <td>$${(ingredient.price * ingredient.quantity).toFixed(2)}</td>
                <td>${ingredient.available ? "In Stock" : "Out of Stock"}</td>
            `;
                    ingredientCostList.appendChild(row);
                    totalCost += ingredient.price * ingredient.quantity;
                });


                totalCostElement.textContent = `$${totalCost.toFixed(2)}`;
                recipeDetailsDiv.style.display = 'block';
            } else {
                recipeDetailsDiv.style.display = 'none';
            }
        }

        ///////////////////////////////////////////////////////////////////////////////////////

        //when user types, it'll find the ingredient in the list
        function filterIngredients() {
            const input = document.getElementById('ingredientInput');
            const filter = input.value.toLowerCase();
            const dropdown = document.getElementById('dropdownContent');
            dropdown.innerHTML = ''; // Clear previous results

            if (filter) {
                const filteredIngredients = ingredients.filter(ingredient => ingredient.toLowerCase().includes(filter));

                filteredIngredients.forEach(ingredient => {
                    const div = document.createElement('div');
                    div.textContent = ingredient;
                    div.onclick = () => selectIngredient(ingredient);
                    dropdown.appendChild(div);
                });

                //show list
                dropdown.style.display = filteredIngredients.length > 0 ? 'block' : 'none';
            } else {
                dropdown.style.display = 'none'; //if none match
            }
        }

        //choose from dropdown list
        function selectIngredient(ingredient) {
            document.getElementById('ingredientInput').value = ingredient;
            document.getElementById('dropdownContent').style.display = 'none';
        }

        function addIngredient() {
            const ingredientsList = document.getElementById('ingredients-list');

            const ingredientDiv = document.createElement('div');
            ingredientDiv.className = 'ingredient';

            // Create the new ingredient row
            ingredientDiv.innerHTML = `
                <select class="ingredientDropdown" required>
                    <option value="">Select Ingredient</option>
                </select>
                <input type="number" placeholder="Quantity" required min="0" class="initialQuantity">
                <select class="unitDropdown" required>
                    <option value="">Select Units</option>
                </select>
                <button type="button" class="X-button" onclick="deleteIngredient(this)">X</button>
            `;

            ingredientsList.appendChild(ingredientDiv);

            // Populate the new dropdowns
            const newIngredientDropdown = ingredientDiv.querySelector('.ingredientDropdown');
            const newUnitDropdown = ingredientDiv.querySelector('.unitDropdown');

            populateAddNewDropdown(newIngredientDropdown, 'items'); // Populate items dropdown
            populateAddNewDropdown(newUnitDropdown, 'conversions'); // Populate units dropdown

            // Prevent negative values in the new quantity field
            const newQuantityInput = ingredientDiv.querySelector('.initialQuantity');
            newQuantityInput.addEventListener('input', () => {
                if (newQuantityInput.value < 0) {
                    newQuantityInput.value = 0; // Reset to 0 if negative
                }
            });
        }

        function deleteIngredient(button) {
            const ingredientDiv = button.parentElement; // Get the parent div of the delete button
            ingredientDiv.remove(); // Remove the ingredient row from the DOM
        }

        function saveNewRecipe() {
            const recipeName = document.querySelector('.add-recipe-entry input[type="text"]').value; // Recipe Name input
            const recipeDescription = document.querySelector('.add-recipe-entry textarea').value; // Recipe Description input
            const ingredientsList = document.querySelectorAll('#ingredients-list .ingredient'); // All ingredients added

            const items = JSON.parse(localStorage.getItem('items')) || {};
            const conversions = JSON.parse(localStorage.getItem('conversions')) || {};

            const newIngredients = Array.from(ingredientsList).map(ingredientDiv => {
                const ingredientDropdown = ingredientDiv.querySelector('.ingredientDropdown');
                const ingredientName = ingredientDropdown.options[ingredientDropdown.selectedIndex].textContent;
                const quantity = parseFloat(ingredientDiv.querySelector('.initialQuantity').value); // Select by class
                const unitDropdown = ingredientDiv.querySelector('.unitDropdown');
                const unit = unitDropdown.options[unitDropdown.selectedIndex].textContent;

                return {
                    ingredientName: ingredientName,
                    itemID: items[ingredientName] || null, // Get itemID from localStorage
                    quantity: quantity,
                    unit: unit,
                    unitID: conversions[unit].unitID
                };
            });

            fetch('http://localhost:1337/api/addRecipe', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    name: recipeName,
                    description: recipeDescription,
                    userID: localStorage.getItem('userID'), // Get userID from localStorage
                })
            })
                .then(response => response.json())
                .then(data => {
                    if (data.recipeID) {
                        console.log('Recipe added successfully with ID:', data.recipeID);
                        const recipeID = data.recipeID;

                        newIngredients.forEach(ingredient => {
                            if (!ingredient.itemID) {
                                console.error(`Item ID not found for ingredient: ${ingredient.ingredientName}`);
                                return;
                            }

                            fetch('http://localhost:1337/api/addRecipeItem', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json'
                                },
                                body: JSON.stringify({
                                    recipeID: recipeID,
                                    itemID: ingredient.itemID,
                                    quantity: ingredient.quantity,
                                    unitID: ingredient.unitID
                                })
                            })
                                .then(response => response.json())
                                .then(data => {
                                    console.log(`Ingredient ${ingredient.ingredientName} added:`, data);
                                })
                                .catch(error => {
                                    console.error('Error adding ingredient:', error);
                                });
                        });

                        const userID = localStorage.getItem('userID');
                        // fetch('http://localhost:1337/api/userRecipe', {
                        //     method: 'POST',
                        //     headers: {
                        //         'Content-Type': 'application/json'
                        //     },
                        //     body: JSON.stringify({ userID })
                        // })
                        // .then(response => response.json())
                        // .then(data => {
                        //     localStorage.setItem('recipes', JSON.stringify(data));
                        // })
                        // .catch(error => {
                        //     console.error('Error fetching recipes:', error);
                        //     alert('Error fetching recipes');
                        // });


                        recipes = convertRecipes();
                        populateRecipeList();
                    } else {
                        console.error('Failed to add recipe:', data.message);
                    }

                    
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        }



        ////////////////////////////////////////////////////////////////////////////////////////

        //dropdown for recipes
        function populateDropdown() {
            const dropdown = document.getElementById('chooseRecipeUpdate');
            dropdown.innerHTML = ''; // Clear the previous options
            const uniqueRecipes = new Set(); // Use a Set to track unique recipe names

            for (let recipeName in recipes) {
                if (!uniqueRecipes.has(recipeName)) { // Check for duplicates
                    uniqueRecipes.add(recipeName);
                    const option = document.createElement('option');
                    option.value = recipeName;
                    option.textContent = recipeName;
                    dropdown.appendChild(option);
                }
            }
        }
        populateDropdown();

        //get list of recipes to choose from
        function loadRecipeData() {
            const chosenRecipeName = document.getElementById('chooseRecipeUpdate').value;
            if (chosenRecipeName) {
                const recipe = recipes[chosenRecipeName];
                localStorage.setItem('recipeID', recipe.recipeID);
                document.getElementById('recipeName').value = recipe.name;

                document.querySelector('#updateRecipeForm textarea').value = recipe.description;

                //clear out previous
                const ingredientsList = document.getElementById('ingredient-list');
                ingredientsList.innerHTML = '';

                //list out the ingredients
                recipe.ingredients.forEach((ingredient, index) => {
                    const ingredientDiv = document.createElement('div');
                    ingredientDiv.className = 'ingredient-entry';
                    ingredientDiv.innerHTML = `
                                        <input type="text" value="${ingredient.ingredient}" class="ingredient-name">
                                        <input type="number" value="${ingredient.quantity}" class="ingredient-quantity" min = "0">
                                        <input type="text" value="${ingredient.unit}" class="ingredient-unit">
                                        <button type="button" class="X-button" onclick="deleteIngredient(this)">X</button>
                                    `;
                    ingredientsList.appendChild(ingredientDiv);
                });

                //Prevent users from manually entering a negative number
                document.querySelectorAll('.ingredient-quantity').forEach(input => {
                input.addEventListener('input', () => {
                    if (input.value < 0) {
                        input.value = 0; // Reset to 0 if negative number is entered
                    }
                    });
                });

                //show form to update recipe
                document.getElementById('updateRecipeForm').style.display = 'block';
            } else {
                //clear if no recipe chosen
                document.getElementById('updateRecipeForm').style.display = 'none';
            }
        }

        //add another ingredient to recipe
        function addAnotherIngredient() {
            const ingredientsList = document.getElementById('ingredient-list');

            const ingredientDiv = document.createElement('div');
            ingredientDiv.className = 'ingredient-entry';
            ingredientDiv.innerHTML = `
                <select id="ingredientDropdown" required>
                    <option value="">Select Ingredient</option>
                </select>
                <input type="number" class="ingredient-quantity" placeholder="Quantity" required min = "0">
                <select class="ingredient-unit">
                        <option value="Units">Units</option>
                        <option value="Cups">Cups</option>
                        <option value="Pounds">Pounds</option>
                        <option value="Ounces">Ounces</option>
                </select>
                <button type="button" class="X-button" onclick="deleteIngredient(this)">X</button>
                `;

                ingredientsList.appendChild(ingredientDiv);

                const quantityInput = ingredientDiv.querySelector('.ingredient-quantity');
                quantityInput.addEventListener('input', () => {
                    if (quantityInput.value < script) {
                        quantityInput.value = 0; // Reset to 0 if negative number is entered
                    }
                });

        function saveRecipe() {
            const recipeName = document.getElementById('recipeName').value;
            const ingredientsList = document.getElementById('ingredient-list').children;

            const updatedIngredients = Array.from(ingredientsList).map(ingredientDiv => ({
                ingredient: ingredientDiv.querySelector('.ingredient-name').value,
                quantity: parseFloat(ingredientDiv.querySelector('.ingredient-quantity').value),
                unit: ingredientDiv.querySelector('.ingredient-unit').value
            }));

            //update the recipe (change later to connect to database)
            recipes[recipeName] = { name: recipeName, ingredients: updatedIngredients };

            alert('Recipe updated successfully!');
        }

        function deleteRecipe() {
            const recipeName = document.getElementById('recipeName').value;
            const ingredientsList = document.getElementById('ingredient-list').children;
            //update the recipe (change later to connect to database)
            //recipes[recipeName] = { name: recipeName, ingredients: updatedIngredients };
            if (recipes.hasOwnProperty(recipeName)) {
                delete recipes[recipeName];
                alert('Recipe deleted successfully');
            }
            else {
                alert('error cannot delete');
            }
        }

        ////////////////////////////////////////////////////////////////////////////////////////

        //shows dropdown for the recipes to select from to show cost
        function populateRecipeCostDropdown() {
            const dropdown = document.getElementById('chooseRecipeCost');
            dropdown.innerHTML = '<option value="">Select a recipe</option>'; //to reset

            for (const recipeName in recipes) {
                const option = document.createElement('option');
                option.value = recipeName;
                option.textContent = recipeName;
                dropdown.appendChild(option);
            }
        }
        populateRecipeCostDropdown();

        //show recipe cost details
        function viewRecipeCost() {
            const chosenRecipeName = document.getElementById('chooseRecipeCost').value;
            const recipeDetailsDiv = document.getElementById('recipeCostDetails');
            const ingredientCostList = document.getElementById('ingredientCostList');
            const totalCostElement = document.getElementById('totalCost');

            if (chosenRecipeName && recipes[chosenRecipeName]) {
                const recipe = recipes[chosenRecipeName];
                document.getElementById('chosenRecipeName').textContent = recipe.name;

                const recipeDescription = document.getElementById('recipeDescriptionCostBox');
                recipeDescription.value = recipe.description;
                ingredientCostList.innerHTML = '';
                let totalCost = 0;  //to start with then add the costs
                

                //show the list of recipe details with cost
                recipe.ingredients.forEach((ingredient) => {
                    const row = document.createElement('tr');

                    row.innerHTML = `
                                    <td>${ingredient.ingredient}</td>
                                    <td>${ingredient.quantity}</td>
                                    <td>${ingredient.unit}</td>
                                    <td>$${(ingredient.price * ingredient.quantity).toFixed(2)}</td>
                                    <td>${ingredient.available ? "In Stock" : "Out of Stock"}</td>
                                `;

                    ingredientCostList.appendChild(row);
                    totalCost += ingredient.price * ingredient.quantity;
                });

                totalCostElement.textContent = `$${totalCost.toFixed(2)}`;
                recipeDetailsDiv.style.display = 'block';
            } else {
                recipeDetailsDiv.style.display = 'none';
                alert('Select a recipe.');
            }
        }
    } 

    </script>
</body>
</html>